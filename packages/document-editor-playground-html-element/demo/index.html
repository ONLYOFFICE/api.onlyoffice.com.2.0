<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>ONLYOFFICE Document Editor Playground HTML Element</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
    body, pre {
      margin: 0;
    }
    document-editor {
      display: block;
      height: 60vh;
    }
    p {
      padding: 0px 24px;
    }
    label {
      display: block;
      padding: 12px 24px;
    }
    label code {
      display: block
    }
    </style>
    <script type="module" src="../node_modules/@onlyoffice/document-editor-html-element/lib/main.ts"></script>
    <script type="module" src="../node_modules/@onlyoffice/document-editor-mirror-html-element/lib/main.ts"></script>
    <script type="module" src="../lib/main.ts"></script>
  </head>
  <body>
    <document-editor-playground>
      <form>
        <output>
          <document-editor-mirror>
            <document-editor document-server-url="http://0.0.0.0:3000/" config="{}"></document-editor>
          </document-editor-mirror>
        </output>
        <p>
          <button type="submit" value="reset">Reset</button>
          <button type="submit" value="play">Play</button>
        </p>
        <label>
          <code>documentType</code>
          <select name="documentType">
            <option value="">Please select a document type</option>
            <option value="word">word</option>
            <option value="cell">cell</option>
          </select>
        </label>
        <label>
          <code>document.fileType</code>
          <select name="document.fileType">
            <option value="">Please select a file type</option>
            <option value="docx">docx</option>
            <option value="xlsx">xlsx</option>
          </select>
        </label>
        <label>
          <code>document.title</code>
          <input name="document.title" type="text" placeholder="Please enter a title">
        </label>
        <label>
          <code>editorConfig.customization.compactHeader</code>
          <input name="editorConfig.customization.compactHeader" type="checkbox">
        </label>
        <label>
          <code>events.onAppReady</code>
          <textarea id="events.onAppReady" name="events.onAppReady">// Here you can add code that will be executed after the editor is ready</textarea>
          <output for="events.onAppReady"><pre><code data-output-for="events.onAppReady">// Here, the console output will be displayed</code></pre></output>
        </label>
        <label>
          <code>events.onDocumentReady</code>
          <textarea id="events.onDocumentReady" name="events.onDocumentReady">// Here you can add code that will be executed after the document is ready</textarea>
          <output for="events.onDocumentReady"><pre><code data-output-for="events.onDocumentReady">// Here, the console output will be displayed</code></pre></output>
        </label>
      </form>
    </document-editor-playground>

    <script type="module">
    const fm = document.querySelector("form")
    fm.addEventListener("submit", async (e) => {
      if (e.submitter.value === "reset") {
        return
      }
      e.preventDefault()
      const dp = document.querySelector("document-editor-playground")
      const cu = new URL("/config", "http://0.0.0.0:4000/")
      const cr = await fetch(cu, {
        method: "POST",
        body: JSON.stringify(dp.config),
        headers: {"Content-Type": "application/json"}
      })
      const cf = await cr.json()
      // dp.clear()
      dp.play(cf)
    })
    </script>
  </body>
</html>